<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>BBC introduction to coding principles</title>
    <!-- Font Awesome icons (free version)-->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"
      crossorigin="anonymous"
    ></script>
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />
    <!-- Fonts CSS-->
    <link rel="stylesheet" href="css/heading.css" />
    <link rel="stylesheet" href="css/body.css" />
  </head>
  <body id="page-top">
    <nav class="navbar navbar-expand-lg bg-secondary fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top"
          >Team Cyanide Quiz</a
        >
        <button
          class="navbar-toggler navbar-toggler-right font-weight-bold bg-primary text-white rounded"
          type="button"
          data-toggle="collapse"
          data-target="#navbarResponsive"
          aria-controls="navbarResponsive"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          Menu <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto" id="navbarResponsiveItems">
            
          </ul>
        </div>
      </div>
    </nav>
    <header class="masthead bg-primary text-black text-center">
      <div class="container d-flex align-items-center flex-column">
        <!-- Masthead Heading-->
        <h1 class="masthead-heading mb-0">Quiz</h1>
        <!-- Icon Divider-->
        <div class="divider-custom divider-custom">
          <div class="divider-custom-line"></div>
          <div class="divider-custom-icon"><svg width="50px" height="50px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10.125 8.875C10.125 7.83947 10.9645 7 12 7C13.0355 7 13.875 7.83947 13.875 8.875C13.875 9.56245 13.505 10.1635 12.9534 10.4899C12.478 10.7711 12 11.1977 12 11.75V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <circle cx="12" cy="16" r="1" stroke="currentColor"/>
            <path d="M22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C21.5093 4.43821 21.8356 5.80655 21.9449 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg></div>
          <div class="divider-custom-line"></div>
        </div>
        <!-- Masthead Subheading-->
        <p class="masthead-subheading font-weight-light mb-0">
          Team Cyan 2023
        </p>
      </div>
    </header>
    <section class="text-black" id="topics">
      <div class="container">

        <div class="text-center">
          
        </div>
    </section>


    <!-- Copyright Section-->
    <section class="copyright py-4 text-center text-white">
      <div class="container">
        <small class="pre-wrap">Copyright Â© Your Website 2020</small>
      </div>
    </section>
    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes)-->
    <div class="scroll-to-top d-lg-none position-fixed">
      <a
        class="js-scroll-trigger d-block text-center text-white rounded"
        href="#page-top"
        ><i class="fa fa-chevron-up"></i
      ></a>
    </div>

    <script type="text/javascript" src="quiz.json"></script>
    <script type="text/javascript" src="scoreboard.json"></script>



    <script type="text/javascript">

      // ITS HERE


      var keyValues = []

      for (var key in leaderboard) {
        keyValues.push([key, leaderboard[key]])
      }

      keyValues.sort(function compare(kv1, kv2) {
        // This comparison function has 3 return cases:
        // - Negative number: kv1 should be placed BEFORE kv2
        // - Positive number: kv1 should be placed AFTER kv2
        // - Zero: they are equal, any order is ok between these 2 items
        return kv2[1] - kv1[1]
      })

      console.log(keyValues);

      var template = ""

      for (const element in quiz) {
        template = template + `<li class="nav-item mx-0 mx-lg-1">
              <a
                class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger"
                href="#${element}"
                >${element.toUpperCase()}</a
              >
            </li>`
      }

      document.getElementById("navbarResponsiveItems").innerHTML = template;
    

    </script>

    <script type="text/javascript">


      var template = "";

      for (const element in quiz) {
        
        template = template + `<section class="page-section">
      <div class="container">
        <!-- Section Heading-->
        <div class="text-center">
          <h2 class="page-section-heading text-secondary mb-0 d-inline-block">
            ${element.toUpperCase()}
          </h2>
        </div>
        <!-- Icon Divider-->
        <div class="divider-custom">
          <div class="divider-custom-line"></div>
          <div class="divider-custom-icon"><svg width="50px" height="50px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10.125 8.875C10.125 7.83947 10.9645 7 12 7C13.0355 7 13.875 7.83947 13.875 8.875C13.875 9.56245 13.505 10.1635 12.9534 10.4899C12.478 10.7711 12 11.1977 12 11.75V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <circle cx="12" cy="16" r="1" stroke="currentColor"/>
            <path d="M22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C21.5093 4.43821 21.8356 5.80655 21.9449 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg></div>
          <div class="divider-custom-line"></div>
        </div>
        <!-- Section Content-->
        <div
          class="row"
          id="${element}"
        ></div>
     </div>
    </section>`;

      }


       
      document.getElementById("topics").innerHTML = template;
      
    </script>



    <script>
      var template = "";

      // If not already exists, add choice to save data to localStorage
      let saveData;
      if (localStorage.getItem('saveData') === null) {
        if (confirm("Would you like to save your scores?")) {
          saveData = true;
          let username = prompt('Enter your username')
          localStorage.setItem('username', username);
        } else {
          saveData = false;
        }
        localStorage.setItem('saveData', saveData);
      }

      for (const topic in quiz) {
        quiz[topic].quizquestions.forEach((element, questionIndex) => {

        let ques = element.question;
        let ans = element.correct_answer;

        template = template + `<div class="col-lg-12 ml-auto py-4 border border-dark rounded mb-3" data-id="${questionIndex}">
            <p class="pre-wrap lead">Question - ${ques}</p>
            <p class="pre-wrap lead" id="${topic}-select">`
        element.answers.forEach((answer, internalIndex) => {
            template = template + `<button onclick="check(this, '${internalIndex + 1}', ${ans}, ${questionIndex}, '${topic}')" class="btn btn-outline-dark btn-lg m-1">${answer}</button>`
        });

        template = template + `</p>
            <!--<button onclick="check(${this}, '${topic}', ${ans})">Check this answer</button>-->
          </div>`;

          
        document.getElementById(topic).innerHTML = template;
        
      }
      );
      template = "";

      // Initialise dictionary and inner array in
      let blankMetrics = new Array(quiz[topic].quizquestions.length).fill(null);
      localStorage.setItem(`${topic}Metrics`, JSON.stringify(blankMetrics))
    }  

      function check(buttonObj, answervalue, correctanswer, questionIndex, topic) {
        if (+answervalue == +correctanswer) {
          // label the question as true
          let currentLocal = JSON.parse(localStorage.getItem(`${topic}Metrics`));
          currentLocal[questionIndex] = true;
          localStorage.setItem(`${topic}Metrics`, JSON.stringify(currentLocal));

          // Add style to answer
          buttonObj.style.color = 'green';
          buttonObj.closest('[data-id]').style = 'border-color: green !important; border-width: thick !important;';
        } else {
          // label the question as false
          let currentLocal = JSON.parse(localStorage.getItem(`${topic}Metrics`));
          currentLocal[questionIndex] = false;
          localStorage.setItem(`${topic}Metrics`, JSON.stringify(currentLocal));

          // Add style to answer
          buttonObj.style.color = 'red';
          buttonObj.closest('[data-id]').style = 'border-color: red !important; border-width: thick !important;';
          
        }
        // Disable the button
        buttonObj.closest('p').querySelectorAll('button').forEach((btn) => {
            btn.disabled = true;
          })
      }
    </script>
    <!-- Bootstrap core JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <!-- Third party plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>
  </body>
</html>